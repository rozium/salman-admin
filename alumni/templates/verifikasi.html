{% extends "base.html" %}

{% block title %}Verifikasi{% endblock %}

{% block style %}
<style type="text/css">
    div#content {
        margin: auto;
        padding-top: 20px;
        width: 95%;
    }
    .verif-table2 tr#child:hover {
      background-color: peru !important;
    }
</style>
{% endblock %}

{% block content %}
<div class="verif-content1">

    <h1 style="font-family: Roboto-Black; color: #795547;">Verifikasi Akun</h1>
    <br>
    <table class="verif-table2">
      <tr style="color: white; font-size: 18px;">
        <th style="width: 8%;">No</th>
        <th>Nama Lengkap</th>
        <th>Email</th>
      </tr>

      <!-- Django Loop templates -->
      {% for user in users %}
          <tr id="child">
            <td>{{ forloop.counter }}</td>
            <td>{{ user.nama }}</td>
            <td>{{ user.email }}</td>
          </tr>
      {% endfor %}
        

    </table>
</div>

<div class="verif-content2">
    <h1 style="font-family: Roboto-Black; color: #795547; text-align: right;" id="verif-nama">---</h1>
    <br>
    <table class="tg" style="table-layout: fixed; width: 100%">
    <colgroup>
    <col style="width: 100px">
    <col style="width: 160px">
    <col style="width: 3px">
    <col style="width: 170px">
    <col style="width: 80px">
    </colgroup>
      <tr>
        <td class="tg-4d50">Jenis Kelamin</td>
        <td class="tg-5xe6" id="verif-gender">-</td>
        <td class="tg-garis"></td>
        <td class="tg-4d50">Aktifitas Yang diikuti</td>
        <td class="tg-4d50" style="text-align: right;">Tahun aktif</td>
      </tr>
      <tr>
        <td class="tg-4d50">Negara</td>
        <td class="tg-5xe6" id="verif-negara">-</td>
        <td class="tg-garis"></td>
        <td class="tg-5xe6" id="verif-aktifitas-1">-</td>
        <td class="tg-jjuf" id="verif-tahun_aktif-1">-</td>
      </tr>
      <tr>
        <td class="tg-4d50">Kota</td>
        <td class="tg-5xe6" id="verif-kota">-</td>
        <td class="tg-garis"></td>
        <td class="tg-5xe6" id="verif-aktifitas-2">-</td>
        <td class="tg-jjuf" id="verif-tahun_aktif-2">-</td>
      </tr>
      <tr>
        <td class="tg-4d50">Alamat</td>
        <td class="tg-5xe6" id="verif-alamat">-</td>
        <td class="tg-garis"></td>
        <td class="tg-5xe6" id="verif-aktifitas-3">-</td>
        <td class="tg-jjuf" id="verif-tahun_aktif-3">-</td>
      </tr>
      <tr>
        <td class="tg-4d50">Universitas</td>
        <td class="tg-5xe6" id="verif-univ">-</td>
        <td class="tg-garis"></td>
        <td class="tg-5xe6" id="verif-aktifitas-4">-</td>
        <td class="tg-jjuf" id="verif-tahun_aktif-4">-</td>
      </tr>
      <tr>
        <td class="tg-4d50">Jurusan</td>
        <td class="tg-5xe6" id="verif-jurusan">-</td>
        <td class="tg-garis"></td>
        <td class="tg-5xe6" id="verif-aktifitas-5">-</td>
        <td class="tg-jjuf" id="verif-tahun_aktif-5">-</td>
      </tr>
      <tr>
        <td class="tg-4d50">Angkatan Kuliah</td>
        <td class="tg-5xe6" id="verif-ang_kuliah">-</td>
        <td class="tg-garis"></td>
        <td class="tg-5xe6" id="verif-aktifitas-6">-</td>
        <td class="tg-jjuf" id="verif-tahun_aktif-6">-</td>
      </tr>
      <tr>
        <td class="tg-4d50">Angkatan LMD / SII</td>
        <td class="tg-5xe6" id="verif-ang_LMD">-</td>
        <td class="tg-garis"></td>
        <td class="tg-5xe6" id="verif-aktifitas-7">-</td>
        <td class="tg-jjuf" id="verif-tahun_aktif-7">-</td>
      </tr>
      <tr>
        <td class="tg-4d50">Pekerjaan</td>
        <td class="tg-5xe6" id="verif-pekerjaan">-</td>
        <td class="tg-garis"></td>
        <td class="tg-eh2d"></td>
        <td class="tg-eh2d"></td>
      </tr>
      <tr>
        <td class="tg-4d50">Nama Instansi</td>
        <td class="tg-5xe6" id="verif-instansi">-</td>
        <td class="tg-garis"></td>
        <td class="tg-eh2d"></td>
        <td class="tg-eh2d"></td>
      </tr>
      <tr>
        <td class="tg-4d50">No. HP</td>
        <td class="tg-5xe6" id="verif-no_hp">-</td>
        <td class="tg-garis"></td>
        <td class="tg-eh2d"></td>
        <td class="tg-eh2d"></td>
      </tr>
      <tr>
        <td style="background-color: #eee; padding: 2px" class="tg-4d50"></td>
        <td style="background-color: #eee; padding: 2px" class="tg-5xe6"></td>
        <td style="background-color: #eee; padding: 2px" class="tg-garis"></td>
        <td style="background-color: #eee; padding: 2px" class="tg-eh2d"></td>
        <td style="background-color: #eee; padding: 2px" class="tg-eh2d"></td>
      </tr>

      <tr>
        <td class="tg-4d50">Pertanyaan 1</td>
        <td class="tg-5xe6" id="verif-pertanyaan1">-</td>
        <td class="tg-eh2d"></td>
        <td class="tg-5xe6" colspan="2" id="verif-jawaban1">-</td>
      </tr>
      <tr>
        <td class="tg-4d50">Pertanyaan 2</td>
        <td class="tg-5xe6" id="verif-pertanyaan2">-</td>
        <td class="tg-eh2d"></td>
        <td class="tg-5xe6" colspan="2" id="verif-jawaban2">-</td>
      </tr>    
    </table>
    <button onclick="verifikasi()" class="buttonConfirm"><span>Konfirmasi </span></button>
</div>
{% endblock %}

{% block script %}
<script type="text/javascript">

    var selectedEmail;

    function verifikasi() {
      if (selectedEmail) {
        if (confirm("Apakah anda yakin verifikasi akun dengan email " + selectedEmail + "?")) {
          $.ajax({
            url: '{% url "verifconfirm" %}',
            data: {
              'email': selectedEmail,
            },
            dataType: 'json',
            success: function (data) {
              alert(data.msg);
              location.reload();
            }
          });
        }
      } else {
        alert('Silahkan pilih Akun terlebih dahulu');
      }
    }

    $('.verif-table2 tr#child').hover(function() {
      $(this).addClass('hover');
    }, function() {
      $(this).removeClass('hover');
    });

    $(".verif-table2").on("click", "tr", function() {
      var email = $(this).find("td").eq(2).html();
      if (selectedEmail != email) {
        $.ajax({
          url: '{% url "verifuser" %}',
          data: {
            'email': email,
          },
          dataType: 'json',
          success: function (data) {
            
            selectedEmail = email;

            var users = JSON.parse(data.users);
            users = users[0]['fields'];
            
            var nama = users['nama'];
            var gender = users['gender'];
            var alamat = users['alamat'];
            var negara = users['negara'];
            var kota = users['kota'];
            var no_hp = users['no_hp'];
            var univ = users['univ'];
            var jurusan = users['jurusan'];
            var ang_kuliah = users['ang_kuliah'];
            var ang_LMD = users['ang_LMD'];
            var pekerjaan = users['pekerjaan'];
            var instansi = users['instansi'];
            var aktifitas = users['aktifitas'];
            var tahun_aktif = users['tahun_aktif'];
            var pertanyaan1 = users['pertanyaan1'];
            var pertanyaan2 = users['pertanyaan2'];
            var jawaban1 = users['jawaban1'];
            var jawaban2 = users['jawaban2'];

            $("#verif-nama").text(nama);
            $("#verif-gender").text(gender);
            $("#verif-alamat").text(alamat);
            $("#verif-negara").text(negara);
            $("#verif-kota").text(kota);
            $("#verif-no_hp").text(no_hp);
            $("#verif-univ").text(univ);
            $("#verif-jurusan").text(jurusan);
            $("#verif-ang_kuliah").text(ang_kuliah);
            $("#verif-ang_LMD").text(ang_LMD);
            $("#verif-pekerjaan").text(pekerjaan);
            $("#verif-instansi").text(instansi);
            $("#verif-pertanyaan1").text(pertanyaan1);
            $("#verif-pertanyaan2").text(pertanyaan2);
            $("#verif-jawaban1").text(jawaban1);
            $("#verif-jawaban2").text(jawaban2);

            aktifitas = JSON.parse(aktifitas);
            for (var i = 1; i < 7 + 1; i++) {
              $("#verif-aktifitas-" + i).text('-');
            }

            var i = 1;
            aktifitas.forEach(function(item) {
              $("#verif-aktifitas-" + i).text(item);
              i++;
            });

            tahun_aktif = JSON.parse(tahun_aktif);
            for (var i = 1; i < 7 + 1; i++) {
              $("#verif-tahun_aktif-" + i).text('-');
            }

            var i = 1;
            tahun_aktif.forEach(function(item) {
              $("#verif-tahun_aktif-" + i).text(item);
              i++;
            });

          }
        });
      }
    });

</script>
{% endblock %}
